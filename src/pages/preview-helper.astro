---
// Simple page to generate preview links
---

<html>
<head>
  <title>Preview Link Generator</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    .input-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
    }
    input, select {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
    }
    button {
      background: #0DC09D;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      font-weight: 600;
    }
    button:hover {
      background: #0aa889;
    }
    .preview-link {
      margin-top: 20px;
      padding: 15px;
      background: #f0f0f0;
      border-radius: 4px;
      word-break: break-all;
    }
    .preview-link a {
      color: #0DC09D;
      text-decoration: none;
      font-weight: 600;
    }
    .instructions {
      margin-top: 20px;
      padding: 15px;
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç Preview Link Generator</h1>
    
    <div class="instructions">
      <strong>How to use:</strong>
      <ol>
        <li>Select the page you want to preview</li>
        <li>Click "Generate Preview Link"</li>
        <li>Click the generated link to view draft content</li>
        <li>Make sure you've saved your changes in Sanity (don't need to publish)</li>
      </ol>
    </div>

    <div class="input-group">
      <label for="page-select">Select Page to Preview:</label>
      <select id="page-select">
        <option value="/">Homepage</option>
        <option value="/2026/boston/overview">Boston Overview</option>
        <option value="/2026/boston/agenda">Boston Agenda</option>
        <option value="/2026/boston/training">Boston Training</option>
        <option value="/2026/boston/travel">Boston Travel</option>
        <option value="/2026/boston/hackathon">Boston Hackathon</option>
        <option value="/2026/barcelona/overview">Barcelona Overview</option>
        <option value="/2026/barcelona/agenda">Barcelona Agenda</option>
        <option value="/2026/barcelona/training">Barcelona Training</option>
        <option value="/2026/barcelona/travel">Barcelona Travel</option>
        <option value="/2026/barcelona/hackathon">Barcelona Hackathon</option>
        <option value="/2026/virtual/overview">Virtual Overview</option>
        <option value="/2026/virtual/agenda">Virtual Agenda</option>
        <option value="/why-attend">Why Attend</option>
        <option value="/call-for-abstracts">Call for Abstracts</option>
        <option value="/past-events">Past Events</option>
      </select>
    </div>

    <div class="input-group">
      <label for="custom-path">Or enter custom page path:</label>
      <input 
        type="text" 
        id="custom-path" 
        placeholder="/your-custom-path"
      />
    </div>

    <button onclick="generateLink()">Generate Preview Link</button>

    <div id="result" style="display: none;" class="preview-link">
      <strong>Preview Link:</strong><br>
      <a id="preview-link" href="#" target="_blank"></a>
    </div>
  </div>

<script is:inline>
  function generateLink() {
    const select = document.getElementById('page-select');
    const customPath = document.getElementById('custom-path');
    const path = customPath.value || select.value;
    
    console.log('Selected path:', path); // Debug log
    
    // Use production URL if on production, otherwise use current origin
    const baseUrl = 'https://summit.nextflow.io'; // Change this to your actual domain
    const previewUrl = `${baseUrl}/api/preview?redirect=${encodeURIComponent(path)}`;
    
    console.log('Generated URL:', previewUrl); // Debug log
    
    const linkElement = document.getElementById('preview-link');
    linkElement.href = previewUrl;
    linkElement.textContent = previewUrl;
    
    document.getElementById('result').style.display = 'block';
    
    // Also open it automatically
    window.open(previewUrl, '_blank');
  }
</script>
</body>
</html>